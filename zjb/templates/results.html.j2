{% extends "base.html.j2" %}
{% block navigation %}
        <nav>
            <div>
                <label for="group">Group:</label>
                <select name="group" id="group">
                    <option>ANY</option>
                </select>
            </div>
            <div>
                <label for="search">Search:</label>
                <input type="search" name="search" id="search" autocomplete="off" />
            </div>
            <div>
                <label>Quick:</label>
                <input type="button" id="failed" value="Failed" />
                <input type="button" id="tested" value="Tested" />
                <input type="button" id="untested" value="Untested" />
            </div>
        </nav>
{% endblock %}
{% block content %}
            {%- for pipeline in results %}
            <table class="view">
                <caption><span>{{ name }} / {{ pipeline }}</span></caption>
                <thead>
                    <tr>
                        <td><!-- --></td>
                        {%- for branch in headers %}
                        <td colspan="{{ headers[branch] | length }}">{{ branch }}</th>
                        {%- endfor -%}
                    </tr>
                    <tr>
                        <th>Project</th>
                        {%- for branch in headers %}
                            {%- for job in headers[branch] %}
                        <th>{{ job }}</th>
                            {%- endfor -%}
                        {%- endfor -%}
                    </tr>
                </thead>
                <tbody>
                    {%- for project_name, project_results in results[pipeline].items() %}
                    <tr>
                        <td>{{ project_name }}</td>
                        {%- for result in project_results %}
                        <td>
                            {%- if result -%}
                            <a class="status {{ result.status }} {% if result.voting %}voting{% else %}non-voting{% endif %}" href="{{ url_prefix }}details?id={{ result.id }}">{{ result.status }}{% if result.notes -%}<span class="notes"></span>{%- endif %}</a>
                            <div class="overlay">
                                <div class="details details-box" id="details-for-{{ result.id }}">
                                    <form action="{{ url_prefix }}details?id={{ result.id }}" method="post">
                                        <p class="id"><a href="{{ url_prefix }}details?id={{ result.id }}">#{{ result.id }}</a></p>
                                        <strong>Build details</strong>
                                        <table>
                                            <tr>
                                                <td>Project:</td>
                                                <td><b>{{ result.project }}</b></td>
                                                <td>Job name:</td>
                                                <td><b>{{ result.job }}</b></td>
                                            </tr>
                                            <tr>
                                                <td>Branch:</td>
                                                <td><b>{{ result.branch }}</b></td>
                                                <td>Pipeline:</td>
                                                <td><b>{{ result.pipeline }}</b></td>
                                            </tr>
                                            <tr>
                                                <td>Status:</td>
                                                <td><b class="status {{ result.status }} {% if result.voting %}voting{% else %}non-voting{% endif %}">{{ result.status }}</b></td>
                                                <td>Date:</td>
                                                <td>{% if result.date %}<b>{{ result.date }}</b>{% else %}(N/A){% endif %}</td>
                                            </tr>
                                            <tr>
                                                <td>UUID:</td>
                                                <td>{% if result.uuid %}<b>{{ result.uuid }}</b>{% else %}(N/A){% endif %}</td>
                                                <td>Updated:</td>
                                                <td><b>{{ result.updated }}</b></td>
                                            </tr>
                                            <tr>
                                                <td>Logs:</td>
                                                <td class="log" colspan="3">{% if result.URL %}<a href="{{ result.URL }}">{{ result.URL }}</a>{% else %}(N/A){% endif %}</td>
                                            </tr>
                                            <tr>
                                                <td colspan="4">
                                                    Notes:<br />
                                                    <textarea id="notes" name="notes" rows="7" cols="80">{% if result.notes %}{{ result.notes }}{% endif %}</textarea>
                                                </td>
                                            </tr>
                                        </table>
                                        <div>
                                            <button type="reset" value="reset">Cancel</button>
                                            <span>(or press <code>[ESC]</code> key)</span>
                                            <div class="hfill"><!-- --></div>
                                            <button type="submit" value="submit">Save</button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                            {%- endif -%}
                        </td>
                        {%- endfor -%}
                    </tr>
                    {%- endfor -%}
                </tbody>
                <tfoot hidden="hidden">
                    <tr>
                        <td colspan="{{ results.values() | first | items | first | last | length + 1 }}">↕ (content collapsed) ↕</td>
                    </tr>
                </tfoot>
            </table>
            {%- endfor -%}
{% endblock %}
